<!doctype html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WeAreAdmin</title>
  <link rel="stylesheet" th:href="@{assets/css/admin.styles.min.css}"/>
</head>

<body>
<!--  Body Wrapper -->
<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
     data-sidebar-position="fixed" data-header-position="fixed">
  <!-- Sidebar Start -->
  <aside class="left-sidebar">
    <!-- Sidebar scroll-->
    <div>
      <div class="brand-logo d-flex align-items-center justify-content-between">
        <a href="#" class="text-nowrap logo-img" style="padding-top: 3%;">
          <div style="display: flex; justify-content: center; align-items: center;">
            <img th:src="@{assets/img/logo/eplogo_black.png}" width="90" alt="" />&nbsp;
            <span style="font-size: 2rem; font-weight: 800; color: black;">WeAre</span>
          </div>
        </a>
        <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
          <i class="ti ti-x fs-8"></i>
        </div>
      </div>
      <!-- Sidebar navigation-->
      <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
        <ul id="sidebarnav">
          <li class="nav-small-cap">
            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
            <span class="hide-menu">Home</span>
          </li>
          <li class="sidebar-item">
            <a class="sidebar-link" th:href="@{admin}" aria-expanded="false">
                <span>
                  <i class="ti ti-layout-dashboard"></i>
                </span>
              <span class="hide-menu">Dashboard</span>
            </a>
          </li>
        </ul>
      </nav>
      <!-- End Sidebar navigation -->
    </div>
    <!-- End Sidebar scroll-->
  </aside>
  <!--  Sidebar End -->
  <!--  Main wrapper -->
  <div class="body-wrapper">
    <!--  Header Start -->
    <!--  Header End -->
    <div class="container-fluid" style="width: 100%; max-width: 1600px;">
      <div class="card w-100">
        <div class="card-header">
          <span style="font-size: 1.5rem; font-weight: 800;">승인 대기 회원</span>
        </div>
        <div class="card-body">
          <div class="d-sm-flex d-block align-items-center justify-content-between mb-9">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">ID</th>
                  <th scope="col">이름</th>
                  <th scope="col">조</th>
                  <th scope="col">사역팀</th>
                  <th scope="col">생일</th>
                  <th scope="col">휴대폰</th>
                  <th scope="col">주소</th>
                  <th scope="col">승인</th>
                </tr>
              </thead>
              <tbody class="table-group-divider">
                <tr th:each="user, userStat : ${unCheckedUserList}">
                  <th scope="row" th:text="${userStat.index + 1}"></th>
                  <td th:text="${user.userId}"></td>
                  <td th:text="${user.userName}"></td>
                  <td th:text="${user.teamName}"></td>
                  <td th:text="${user.msTeamName}"></td>
                  <td th:text="${user.birthday}"></td>
                  <td th:text="${user.phone}"></td>
                  <td th:text="${user.address}"></td>
                  <td>
                    <button type="button" class="btn btn-primary" th:data-userId="${user.userId}" th:onclick="approveUser(this.getAttribute('data-userId'))">승인하기</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid" style="width: 100%; max-width: 1600px;">
      <div class="card w-100">
        <div class="card-header">
          <span style="font-size: 1.5rem; font-weight: 800;">회원 목록</span>
        </div>
        <div class="card-body">
          <div class="d-sm-flex d-block align-items-center justify-content-between mb-9">
            <table class="table align-middle">
              <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">ID</th>
                <th scope="col">이름</th>
                <th scope="col">조</th>
                <th scope="col">사역팀</th>
                <th scope="col">생일</th>
                <th scope="col">휴대폰</th>
                <th scope="col">주소</th>
              </tr>
              </thead>
              <tbody class="table-group-divider">
              <tr th:each="user, userStat : ${checkedUserList}">
                <th scope="row" th:text="${userStat.index + 1}"></th>
                <td th:text="${user.userId}"></td>
                <td th:text="${user.userName}"></td>
                <td th:text="${user.teamName}"></td>
                <td th:text="${user.msTeamName}"></td>
                <td th:text="${user.birthday}"></td>
                <td th:text="${user.phone}"></td>
                <td th:text="${user.address}"></td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script th:src="@{assets/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{assets/js/sidebarmenu.js}"></script>
<script th:src="@{assets/js/app.min.js}"></script>
<!-- <script src="../assets/js/dashboard.js"></script> -->
</body>

<script>
  function approveUser(userId) {
    // 사용자에게 확인을 받고 승인할지 여부 확인
    var confirmApproval = confirm("사용자를 승인하시겠습니까?");

    console.log(userId);

    if (confirmApproval) {
      // jQuery Ajax를 사용하여 서버로 userId를 전송
      $.ajax({
        type: "POST",
        url: "/weare/admin/approveUser.do",
        data: { userId: userId },
        success: function(response) {
          // 서버 응답을 처리
          console.log(response);
          alert(response);
          // 여기에서 페이지 새로고침 또는 다른 동작 수행
          window.location.reload();
        },
        error: function(error) {
          console.error("Ajax 요청 실패:", error);
        }
      });
    }
  }
</script>

</html>